prometheus:
  prometheusSpec:
    additionalScrapeConfigs:
    - job_name: "prometheus-cluster"
      scheme: http
      honor_labels: true
      metrics_path: "/federate"
      scrape_interval: 30s
      params:
        'match[]':
        - '{__name__=~".+"}'
      static_configs:
      - targets: 
        - "prometheus-01.haas-440.pez.pivotal.io"
        - "prometheus-02.haas-440.pez.pivotal.io"
    - job_name: "etcd-${CLUSTER_NAME}"
      file_sd_configs:
      - files:
        - '/var/vcap/store/bosh-exporter/bosh_target_groups.json'
      scheme: https
      tls_config:
        ca_file: "/etc/prometheus/secrets/etcd-client/etcd-client-ca.crt"
        cert_file: "/etc/prometheus/secrets/etcd-client/etcd-client.crt"
        key_file:  "/etc/prometheus/secrets/etcd-client/etcd-client.key"
        server_name: "*.etcd.cfcr.internal"
      relabel_configs:
      - source_labels: [__meta_bosh_job_process_name]
        regex: etcd
        action: keep
      - source_labels: [__meta_bosh_deployment]
        regex: ${SERVICE_INSTANCE_ID}
        action: keep
      - source_labels: [__address__]
        regex:  '(.*)'
        target_label: __address__
        replacement: '${1}:2379'
